test_that("User interface is correctly rendered", {
    cur_header <- .cytomapper_header()
    
    expect_equal(cur_header$name, "header")
    expect_equal(cur_header$attribs$class, "main-header")
    expect_null(cur_header$children[[1]])
    expect_equal(as.character(cur_header$children[[2]]), paste0('<span class="logo">cytomapper v',
                        packageVersion("cytomapper"), '</span>'))
    expect_equal(as.character(cur_header$children[[3]]), "<nav class=\"navbar navbar-static-top\" role=\"navigation\">\n  <span style=\"display:none;\">\n    <i class=\"fa fa-bars\"></i>\n  </span>\n  <a href=\"#\" class=\"sidebar-toggle\" data-toggle=\"offcanvas\" role=\"button\">\n    <span class=\"sr-only\">Toggle navigation</span>\n  </a>\n  <div class=\"navbar-custom-menu\">\n    <ul class=\"nav navbar-nav\">\n      <li class=\"dropdown notifications-menu\">\n        <a href=\"#\" class=\"dropdown-toggle\" data-toggle=\"dropdown\">\n          <i class=\"fa fa-fas fa-download\"></i>\n        </a>\n        <ul class=\"dropdown-menu\">\n          <li class=\"header\"></li>\n          <li>\n            <ul class=\"menu\">\n              <li>\n                <a href=\"#\">\n                  <i class=\"fa fa- text-info\"></i>\n                  <div class=\"form-group shiny-input-container\">\n                    <label class=\"control-label\" for=\"labelCellsBy\">Cell label</label>\n                    <input id=\"labelCellsBy\" type=\"text\" class=\"form-control\" value=\"Cell-Type\"/>\n                  </div>\n                </a>\n              </li>\n              <li>\n                <a href=\"#\">\n                  <i class=\"fa fa- text-info\"></i>\n                  <a id=\"downloadData\" class=\"btn btn-default shiny-download-link \" href=\"\" target=\"_blank\" download style=\"background-color: #3C8DBC; color: white; border-color: #7EA6F8\">\n                    <i class=\"fa fa-download\"></i>\n                    Download selection\n                  </a>\n                </a>\n              </li>\n            </ul>\n          </li>\n        </ul>\n      </li>\n      <li class=\"dropdown tasks-menu\">\n        <a href=\"#\" class=\"dropdown-toggle\" data-toggle=\"dropdown\">\n          <i class=\"fa fa-fas fa-question\"></i>\n        </a>\n        <ul class=\"dropdown-menu\">\n          <li class=\"header\"></li>\n          <li>\n            <ul class=\"menu\">\n              <li>\n                <a href=\"#\">\n                  <i class=\"fa fa- text-info\"></i>\n                  <button id=\"SessionInfo\" type=\"button\" class=\"btn btn-default action-button\" style=\"background-color: #3C8DBC; color: white; border-color: #3C8DBC\">Session Info</button>\n                </a>\n              </li>\n              <li>\n                <a href=\"#\">\n                  <i class=\"fa fa- text-info\"></i>\n                  <button id=\"Help\" type=\"button\" class=\"btn btn-default action-button\" style=\"background-color: #3C8DBC; color: white; border-color: #3C8DBC\">Help</button>\n                </a>\n              </li>\n            </ul>\n          </li>\n        </ul>\n      </li>\n    </ul>\n  </div>\n</nav>")

    cur_sidebar <- .cytomapper_sidebar()
    
    expect_equal(cur_sidebar$name, "aside")
    expect_equal(cur_sidebar$attribs$id, "sidebarCollapsed")
    expect_equal(cur_sidebar$attribs$class, "main-sidebar")
    expect_equal(cur_sidebar$attribs$`data-collapsed`, "false")
    expect_null(cur_sidebar$children[[1]])
    expect_equal(as.character(cur_sidebar$children[[2]]), "<section id=\"sidebarItemExpanded\" class=\"sidebar\">\n  <ul class=\"sidebar-menu\">\n    <li class=\"treeview\">\n      <a href=\"#\">\n        <i class=\"fa fa-fas fa-sliders-h\"></i>\n        <span>General controls</span>\n        <i class=\"fa fa-angle-left pull-right\"></i>\n      </a>\n      <ul class=\"treeview-menu menu-open\" style=\"display: block;\" data-expanded=\"Generalcontrols\">\n        <div class=\"form-group shiny-input-container\">\n          <label class=\"control-label\" for=\"plotCount\">Select number of plots</label>\n          <input class=\"js-range-slider\" id=\"plotCount\" data-min=\"1\" data-max=\"12\" data-from=\"1\" data-step=\"1\" data-grid=\"true\" data-grid-num=\"5.5\" data-grid-snap=\"false\" data-prettify-separator=\",\" data-prettify-enabled=\"true\" data-keyboard=\"true\" data-data-type=\"number\"/>\n        </div>\n        <div class=\"row\">\n          <div class=\"col-sm-12\" style=\"padding-left:30px;\">\n            <p>\n              <strong>Select sample</strong>\n            </p>\n          </div>\n        </div>\n        <div class=\"row\">\n          <div class=\"col-sm-2\">\n            <button id=\"previous.sample\" type=\"button\" class=\"btn btn-default action-button\" style=\"background-color:transparent;border-color:transparent;color:white;margin-left:0px;\">\n              <i class=\"fa fa-angle-left fa-2x\"></i>\n            </button>\n          </div>\n          <div class=\"col-sm-8\" style=\"padding-left:0px;padding-right:0px;\">\n            <div class=\"form-group shiny-input-container\" style=\"width: 100%;\">\n              <label class=\"control-label shiny-label-null\" for=\"sample\"></label>\n              <div>\n                <select id=\"sample\" class=\"form-control\"></select>\n                <script type=\"application/json\" data-for=\"sample\">{\"placeholder\":\"Select a sample\",\"maxItems\":1}</script>\n              </div>\n            </div>\n          </div>\n          <div class=\"col-sm-2\" style=\"padding-left:0px;\">\n            <button id=\"next.sample\" type=\"button\" class=\"btn btn-default action-button\" style=\"background-color:transparent;border-color:transparent;color:white;margin-left:0px;padding-left:0px;\">\n              <i class=\"fa fa-angle-right fa-2x\"></i>\n            </button>\n          </div>\n        </div>\n        <div class=\"form-group shiny-input-container\">\n          <label class=\"control-label\" for=\"assay\">Select which assay to display</label>\n          <div>\n            <select id=\"assay\" class=\"form-control\"></select>\n            <script type=\"application/json\" data-for=\"assay\">{\"placeholder\":\"Select an assay\",\"maxItems\":1}</script>\n          </div>\n        </div>\n      </ul>\n    </li>\n    <li class=\"treeview\">\n      <a href=\"#\">\n        <i class=\"fa fa-far fa-chart-bar\"></i>\n        <span>Plots</span>\n        <i class=\"fa fa-angle-left pull-right\"></i>\n      </a>\n      <ul class=\"treeview-menu menu-open\" style=\"display: block;\" data-expanded=\"Plots\">\n        <div id=\"AdditionalPlots_sidebar\" class=\"shiny-html-output\"></div>\n      </ul>\n    </li>\n    <div id=\"sidebar\" class=\"sidebarMenuSelectedTabItem\" data-value=\"null\"></div>\n  </ul>\n</section>")
    
    cur_body <- .cytomapper_body()
    expect_equal(cur_body$name, "div")
    expect_equal(cur_body$attribs$class, "content-wrapper")
    cur_tab_id <- cur_body$children[[1]][[3]][[1]][[3]][[1]][[3]][[1]][[2]]$`data-tabsetid`
    expect_equal(as.character(cur_body$children[[1]]), paste0('<section class=\"content\">\n  <div class=\"col-sm-12\">\n    <div class=\"nav-tabs-custom\">\n      <ul class=\"nav nav-tabs shiny-tab-input\" id=\"tabbox1\" data-tabsetid=\"', cur_tab_id, '\">\n        <li class=\"active\">\n          <a href=\"#tab-', cur_tab_id, '-1\" data-toggle=\"tab\" data-value=\"tab1\">Scatter Plots</a>\n        </li>\n        <li>\n          <a href=\"#tab-', cur_tab_id, '-2\" data-toggle=\"tab\" data-value=\"tab2\">Images</a>\n        </li>\n      </ul>\n      <div class=\"tab-content\" data-tabsetid=\"', cur_tab_id, '\">\n        <div class=\"tab-pane active\" data-value=\"tab1\" id=\"tab-', cur_tab_id, '-1\">\n          <div id=\"AdditionalPlots_tab1\" class=\"shiny-html-output\"></div>\n        </div>\n        <div class=\"tab-pane\" data-value=\"tab2\" id=\"tab-', cur_tab_id, '-2\">\n          <div id=\"AdditionalPlots_tab2\" class=\"shiny-html-output\"></div>\n        </div>\n      </div>\n    </div>\n  </div>\n</section>'))
})

test_that("UI reacts correctly", {

})